<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Client</title>
    <style>
        body, html {
            height: 100%;
            width: 100%;
            margin: 0;
            display: flex;
            font-family: Arial, sans-serif;
        }

        .left, .right {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .left {
            flex-grow: 1;
            width: 50%;
            border-right: 2px solid #ccc;
            position: relative;
        }

        .right {
            flex-grow: 1;
            width: 50%;
            overflow-y: auto;
            background-color: #f9f9f9;
        }

        #textField {
            width: 100%;
            height: 70vh; /* Take up a large portion of the left side */
            font-size: 24px;
            padding: 10px;
        }

        #sendButton {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 24px;
            cursor: pointer;
        }

        #serverResponses {
            width: 100%;
            padding: 10px;
            font-size: 18px;
            line-height: 1.5;
        }

        .inputs-container {
            display: none;
            margin-top: 20px;
            text-align: center;
        }

        .inputs-container input {
            font-size: 18px;
            padding: 10px;
            margin: 5px;
            width: 100px;
            box-sizing: border-box;
        }

        .inputs-container button {
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="left">
        <textarea id="textField" placeholder="Enter your message here..."></textarea>
        <button id="sendButton">Send</button>
        <div class="inputs-container" id="inputsContainer">
            <h2>Enter 3 Digits</h2>
            <input type="text" id="digit1" placeholder="Digit 1" />
            <input type="text" id="digit2" placeholder="Digit 2" />
            <input type="text" id="digit3" placeholder="Digit 3" />
            <button onclick="sendDigits()">Send Digits</button>
        </div>
    </div>
    <div class="right">
        <div id="serverResponses"></div>
    </div>

    <script>
        const socket = new WebSocket('ws://localhost:8080/ws');

        socket.addEventListener('open', function (event) {
            console.log('WebSocket is connected.');
            // Hide the text field and send button after connection
            document.getElementById('textField').style.display = 'none';
            document.getElementById('sendButton').style.display = 'none';
        });

        socket.addEventListener('message', function (event) {
            console.log('Message from server: ', event.data);
            displayServerResponse(event.data);
        });

        // Send data when the button is clicked
        document.getElementById('sendButton').addEventListener('click', function() {
            const message = document.getElementById('textField').value;
            if (message) {
                socket.send(message);
                console.log('Sent: ', message);
            } else {
                alert('Please enter a message before sending.');
            }
        });

        // Display server responses on the right side
        function displayServerResponse(message) {
            const responseDiv = document.getElementById('serverResponses');
            const parsedMessage = JSON.parse(message);

            if (parsedMessage.PlayerId && parsedMessage.GameId) {
                // Display PlayerId and GameId
                responseDiv.innerHTML = `
                    <p><strong>Player ID:</strong> ${parsedMessage.PlayerId}</p>
                    <p><strong>Game ID:</strong> ${parsedMessage.GameId}</p>
                `;
                document.getElementById('inputsContainer').style.display = 'none';
            } else if (Array.isArray(parsedMessage) && parsedMessage.length === 3) {
                // Display 3 input fields for digits
                document.getElementById('inputsContainer').style.display = 'block';
                document.getElementById('digit1').value = parsedMessage[0];
                document.getElementById('digit2').value = parsedMessage[1];
                document.getElementById('digit3').value = parsedMessage[2];
            }
        }

        function sendDigits() {
            const digit1 = document.getElementById('digit1').value;
            const digit2 = document.getElementById('digit2').value;
            const digit3 = document.getElementById('digit3').value;

            const digits = [digit1, digit2, digit3];

            socket.send(JSON.stringify(digits));
            console.log('Sent digits:', digits);
        }
    </script>
</body>
</html>
